<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<html>
<head>
<!-- dashboard template for slidoc server --->
<!-- edit parameters: site_name, session_name, session_text, discard_url, err_msg -->

{% include "base.html" %}

<script>
function slidocDiscard() {
   if (!window.confirm('Discard changes?')) {
     return false;
   }
   window.location = '/{{site_name}}{% if site_name %}/{% end %}{{discard_url}}';
   return false;
}
function slidocUpdate() {
   var xhr = new XMLHttpRequest();
   xhr.open('GET', "{{site_prefix}}/_reloadpreview", true);
   xhr.send();
   return false;
}
 document.onreadystatechange = function(event) {
    if (document.readyState != "interactive" || !document.body)
        return;
    document.querySelectorAll('textarea').forEach(function(tx){
        tx.style.height = tx.scrollHeight + 12 + 'px';
    });
}
</script>

</head>
<body>

<div class="slidoc-err-msg">{{err_msg}}</div>

<form action="{{site_prefix}}/_edit" method="post" id="slidoc-edit-form" enctype="multipart/form-data" >
  {% module xsrf_form_html() %}
  <div>
    <a href="window.open('{{site_prefix}}/_preview/index.html','{{site_prefix}}_preview').focus()" target=''>Switch to preview</a>
    <button type="button" onclick="slidocUpdate()">Update preview</button>
    <input id="slidoc-edit-submit" type="submit" value="Save">
    <button type="button" onclick="slidocDiscard()">Discard</button>
  </div>
  <fieldset>
    <label for="sessionname">Session:</label>
    <input type="text" id="sessionname" readonly="yes" name="sessionname" value="{{session_name}}"></input>
    <p></p>
    <textarea id="sessiontext" name="sessiontext" style="width: 90%;">{{session_text}}</textarea>
  </fieldset>
</form>

</body>
</html>
